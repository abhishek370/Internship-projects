{% extends 'info/base.html' %}
{% block content %}
<form action="" method="post">
  {% csrf_token %}
  <div class="input-group mb-3">
    <input type="text" class="form-control" name="name" placeholder="Enter Name" aria-label="Name" aria-describedby="button-addon2">
    <button class="btn btn-primary " type="submit" value="submit"> Search</button>
  </div>
</form>
<form action="{% url 'confirm' assc.id %}" method="post">
            {% csrf_token %}
    <div class="card mb-3">
        <div class="card-header">
          <i class="fas fa-table"></i>
         <b>{{ dept1.name }}</b></div>
        <div class="card-body">
          <div class="table-responsive">
            <div id="articles">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
              <thead>
                <tr>
                    <th>Student name</th>
                    <th>Attendence</th>
                </tr>
              </thead>
                <tbody>
                    {% for att in att_list %}
                    <tr>
                    <td>{{att.student.name}}</td>
                    <td>
                        <div class="btn-group btn-group-toggle" data-toggle="buttons">

                                {% if att.status %}
                                <label class="btn btn-outline-success active">
                                    <input type="radio" name="{{ att.student.USN }}" id="option1" autocomplete="off" value="present" checked> Present
                                </label>

                                <label class="btn btn-outline-danger">
                                    <input type="radio" name="{{ att.student.USN }}" id="option2" autocomplete="off" value="absent"> Absent
                                </label>
                                {% else %}
                                <label class="btn btn-outline-success">
                                    <input type="radio" name="{{ att.student.USN }}" id="option1" autocomplete="off" value="present" > Present
                                </label>

                                <label class="btn btn-outline-danger active">
                                    <input type="radio" name="{{ att.student.USN }}" id="option2" autocomplete="off" value="absent" checked> Absent
                                </label>
                                {% endif %}
                        </div>
                    </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
          </div>
            <!-- {% if att_list.has_other_pages %}
										
            <ul class="pagination global pagination-radius float-right mb-xl-0 ml-3">
              {% if att_list.has_previous %}
                <li class="page-item"><a class="page-link" href="?page={{ att_list.previous_page_number }}"><i class="las la-angle-double-left"></i></a></li>
              {% endif %}
              {% for i in att_list.paginator.page_range %}
              {% if att_list.number == i %}	
                <li class="page-item active"><a onclick="ajax_function('{{i}}')" class="page-link" href="#">{{i}}</a></li>	
              {% else %}
                <li class="page-item"><a onclick="ajax_function('{{i}}')" class="page-link" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}	
              {% endfor %}
              {% if att_list.has_next %}				
              <li class="page-item"><a class="page-link" href="?page={{ att_list.next_page_number }}"><i class="las la-angle-double-right"></i></a></li>
              {% endif %}
            </ul>
            {% endif %} -->





            
            <div class="pagination">
              {% for i in page_range %}
              <a style="margin-left: 5px; " href="?page={{ i }}">{{i}}</a>
              {% endfor %}
            </div>


          </div>
        </div>
      </div>


    <input name="submit" class="btn btn-success" type="submit" value="Submit">
</form>

<script>
	$('a').click(function(event){
		// preventing default actions
		event.preventDefault();
		var page_no = $(this).attr('href');
		// ajax call
			$.ajax({
					type: "POST",
					// define url name
					url: "{% url 'edit_att'  aid%}", 
					data : {    
					page_no : page_no, 
					csrfmiddlewaretoken: '{{ csrf_token }}',
				},
				// handle a successful response
				success: function (response) {
					$('#articles').html('')
					$.each(response.results, function(att, val) {
					 //append to post
					$('#articles').append('<h2>' + val.student.name + '</h2><p>'+ val.status +'</p>')
				   });
				},
				error: function () {
					alert('Error Occured');
				}
			}); 
	});    
	</script>

{% endblock %}